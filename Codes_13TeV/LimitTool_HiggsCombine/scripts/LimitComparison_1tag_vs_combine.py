#!/usr/bin/env python
import sys, os, subprocess, string, re
from ROOT import *
from array import array

gROOT.SetBatch(kTRUE);
gStyle.SetOptStat(0)
gStyle.SetOptTitle(0)
gStyle.SetTitleFont(42, "XYZ")
gStyle.SetTitleSize(0.045, "XYZ")
gStyle.SetLabelFont(42, "XYZ")
gStyle.SetLabelSize(0.045, "XYZ")
gStyle.SetCanvasBorderMode(0)
gStyle.SetFrameBorderMode(0)
gStyle.SetCanvasColor(kWhite)
gStyle.SetPadTickX(1)
gStyle.SetPadTickY(1)
t_m = 0.06  ##top margin
b_m = 0.11   ##botton margin
l_m = 0.115  ##left margin
r_m = 0.04  ##right margin
gStyle.SetPadTopMargin(t_m)
gStyle.SetPadBottomMargin(b_m)
gStyle.SetPadLeftMargin(l_m)
gStyle.SetPadRightMargin(r_m)
gROOT.ForceStyle()

masses_gev = array('d', [1000.0, 1050.0, 1100.0, 1150.0, 1200.0, 1250.0, 1300.0, 1350.0, 1400.0, 1450.0, 1500.0, 1550.0, 1600.0, 1650.0, 1700.0, 1750.0, 1800.0, 1850.0, 1900.0, 1950.0, 2000.0, 2050.0, 2100.0, 2150.0, 2200.0, 2250.0, 2300.0, 2350.0, 2400.0, 2450.0, 2500.0, 2550.0, 2600.0, 2650.0, 2700.0, 2750.0, 2800.0, 2850.0, 2900.0, 2950.0, 3000.0, 3050.0, 3100.0, 3150.0, 3200.0, 3250.0, 3300.0, 3350.0, 3400.0, 3450.0, 3500.0, 3550.0, 3600.0, 3650.0, 3700.0, 3750.0, 3800.0, 3850.0, 3900.0, 3950.0, 4000.0, 4050.0, 4100.0, 4150.0, 4200.0, 4250.0, 4300.0, 4350.0, 4400.0, 4450.0, 4500.0, 4550.0, 4600.0, 4650.0, 4700.0, 4750.0, 4800.0, 4850.0, 4900.0, 4950.0])

masses_tev = array('d', [ 0.001 * float(b) for b in masses_gev ])

xs_obs_limits_0tag = array('d', [0.030708255184238573, 0.027769352926908776, 0.03176421093958478, 0.04876789154591263, 0.014790893847867623, 0.01168833262043942, 0.010688883353330306, 0.01029502154145234, 0.011370159919686847, 0.006747675844287904, 0.003664912246679239, 0.002943175510052711, 0.002751399755669207, 0.0028096783204772887, 0.003053803782366843, 0.0030938816698854923, 0.002949948442400071, 0.002814179026568339, 0.0026249330751914606, 0.0023818739301031035, 0.00210704832721143, 0.001986379940117864, 0.002070181052489138, 0.0022537403651657537, 0.002296100595309341, 0.0023371104909055314, 0.0024493970352185345, 0.0023981891073420916, 0.0021997784767051154, 0.0017014922517008745, 0.0011657533561993353, 0.0007915298846725046, 0.0006267494976110248, 0.0005816334935109369, 0.0006166120343140132, 0.0007048196572962276, 0.000839299916380328, 0.0009834692777744981, 0.0011293339598513138, 0.0012437478933081945, 0.0013396839014727737, 0.0013719036675481956, 0.0013419573227138738, 0.0012703378036760427, 0.0011601970759052835, 0.0010205113828775161, 0.00088643393478611, 0.0007538901971354359, 0.0006379472395415582, 0.0005380929257743466, 0.00046345165837774775, 0.00041277430623530825, 0.00037812237375465764, 0.0003466805960650485, 0.00031879124218951743, 0.00028690679079642565, 0.00025273466621432243, 0.00022241703461069726, 0.00019889303828303983, 0.0001756592026836105, 0.0001620881491396998, 0.00014835615926706721, 0.00014090866856046334, 0.00013458483294899448, 0.00013178293858642572, 0.00012872323070609745, 0.00012774399856279478, 0.00012813835184545603, 0.0001302226718811266, 0.00013368843026585156, 0.00014027304421946297, 0.0001474574021420508, 0.0001495310134105706, 0.00015237525685151359, 0.00014867238294343827, 0.00014528203230432715, 0.0001428761929293863, 0.00013515991726481004, 0.00013040159138852717, 0.000127013049824508])

xs_obs_limits_1tag = array('d', [0.010130654289653774, 0.0071711270129650884, 0.007658469304920748, 0.007192779117230486, 0.00512560721028483, 0.0037502120813002237, 0.0032846976214272214, 0.0034634066759241205, 0.003441968231500528, 0.0029402698059685516, 0.0028564359979840093, 0.0032405700807149485, 0.0036400259110672796, 0.003614000191121496, 0.0029477159885905406, 0.002436472974130716, 0.0021955586046395388, 0.0022834944666045793, 0.0026574808330524884, 0.0033608467059298886, 0.003724484206956492, 0.00349893402224251, 0.0030854042629708174, 0.0023304312585285263, 0.00155642210516733, 0.0010911315515077535, 0.0009360135320378678, 0.0008919189737895285, 0.0008539863309108157, 0.0007693258662177345, 0.000804427128868376, 0.000589788531032719, 0.0005680331453078024, 0.0005898948542186961, 0.0006334256693996308, 0.0006512207014390067, 0.0006079462872339818, 0.0005277980079383935, 0.0004393278788904472, 0.00037395583839063657, 0.0003298135478203473, 0.0003109015467502691, 0.0003116755686527458, 0.000321600301574385, 0.0003273972517074178, 0.00031677360719411195, 0.00029667351868603966, 0.0002703826303912559, 0.00024100365535969324, 0.00021262565686718438, 0.0001907258066420779, 0.0001719547153924873, 0.00016362029733127094, 0.00016188901036923983, 0.00016207620768511773, 0.00016296160095719602, 0.0001624111656152742, 0.00015781946122043835, 0.0001532267465125036, 0.00014658091744247415, 0.00014562671504181056, 0.00014844969374738987, 0.0001588501030353746, 0.00017400400086983942, 0.00019910223069850394, 0.00022333877172253322, 0.00023982538491687793, 0.00024812197804090333, 0.00025371984586401074, 0.00025526626705763044, 0.000252171689647412, 0.0002519484137350994, 0.00024867363678037857, 0.00024205444623255458, 0.00023821845307983716, 0.00023462940038946627, 0.00023083882226845425, 0.00022682525627547718, 0.00022215770557089385, 0.00021733343900498425])

xs_obs_limits_comb = array('d', [0.009329051934757377, 0.007363927758930585, 0.007701990054150405, 0.008791778511509675, 0.006749779708510104, 0.0038323465164704106, 0.0028579454113997517, 0.0031232167711695946, 0.0032422354892722768, 0.002685642384878108, 0.0022628969597585586, 0.002406517609109963, 0.0017823070695384574, 0.0020479618129751994, 0.0016081333291869592, 0.0015487251189811523, 0.0016014856459116511, 0.0016835882482527942, 0.0018090425372270312, 0.0020157551074519555, 0.0022606936225257473, 0.00230071152141044, 0.002125990809872886, 0.0017853745816086737, 0.0013856115402294054, 0.0010858746149104263, 0.0010110111940061122, 0.001064861962378513, 0.0010156040279520632, 0.0008251981936511608, 0.000823127857837346, 0.00045188774747916064, 0.0003931300115781023, 0.00039201395743165515, 0.00041543932738442933, 0.00043956210378493947, 0.00044953265281295917, 0.00044989435767485555, 0.0004487378742600519, 0.0004523000200784882, 0.00047278647467417626, 0.0005000036493498938, 0.0005167490921404781, 0.0005027760492060499, 0.00046875423395578226, 0.00041558208217797754, 0.00035647904880444246, 0.0002962772990771443, 0.00024292466992255837, 0.0001999444568564123, 0.00016697955222178166, 0.0001470193749065664, 0.00013696011109111075, 0.00013217443880870138, 0.00012940371727869574, 0.00012438242154451783, 0.00011530415153460993, 0.00010488423509965373, 9.617400848953891e-05, 9.058768093597246e-05, 8.609186933602298e-05, 8.353402205021601e-05, 8.381494777308923e-05, 8.753591242913045e-05, 9.410738440276315e-05, 0.00010488588957657176, 0.00012287390225128894, 0.00013156151678627627, 0.00013903525273062652, 0.00014418130193563522, 0.00014703339271854104, 0.0001491861284781095, 0.00014832368565881841, 0.0001466187712748774, 0.0001441332523707114, 0.00014120990390653328, 0.00013768887987148176, 0.000133688245365804, 0.0001291745055815024, 0.00012429976808608833])

xs_obs_limits_incl = array('d', [0.022936930065301456, 0.01964698743190955, 0.02074974805594213, 0.01730817940970209, 0.011127689000504119, 0.00712534738701488, 0.006619120917647325, 0.007364515583718871, 0.006578060074436538, 0.004586958830057604, 0.00354957932828876, 0.00388654353590401, 0.004131931060981151, 0.003317319590811073, 0.0027551998991445356, 0.00277348312080054, 0.0030301345985531093, 0.0032543045928942493, 0.0033068571986234487, 0.0033714950444915094, 0.003474520697178718, 0.0035062150442692216, 0.0033141668022348657, 0.0028948942178921556, 0.0023898028787956408, 0.002081981419737184, 0.0020971912317776695, 0.002141412130906573, 0.0019194955730047944, 0.0014222886369670798, 0.0009129907603383323, 0.0006713609506387527, 0.000601631573239692, 0.000636081031446202, 0.0007101755382413364, 0.0007983844516313598, 0.0008710418897143124, 0.0009203885431488873, 0.0009608208293680115, 0.0010219787131155063, 0.0010699978390789728, 0.00108587113490241, 0.0010445906887351628, 0.0009763976043501929, 0.0008776765627386369, 0.0007509052701502667, 0.0006072405329490892, 0.0004771007691670018, 0.00038173057007165003, 0.0003129500892218255, 0.0002714186499819603, 0.00024398020645139865, 0.00023019926855488032, 0.0002229670463281343, 0.0002145528645014908, 0.0002039158327068621, 0.00018802635834689853, 0.00016778241492190676, 0.00015384780913186587, 0.0001389062281509322, 0.0001314, 0.00012994438022274636, 0.0001309833311192773, 0.0001341059010055712, 0.0001468127887161738, 0.00016240222978573714, 0.00018032139737033816, 0.0002024255978955625, 0.0002210638618296859, 0.00023330279693011872, 0.00024072642736631275, 0.00024109140677174023, 0.000234988301580714, 0.00023075952157021955, 0.00022246388971011879, 0.00020972862147974455, 0.00019773145222480806, 0.0001861119316722428, 0.00016752029274153966, 0.00014822190236680398])

xs_obs_limits_0tag_fb = array('d', [1000.0 * float(b) for b in xs_obs_limits_0tag ])

xs_obs_limits_1tag_fb = array('d', [1000.0 * float(b) for b in xs_obs_limits_1tag ])

xs_obs_limits_comb_fb = array('d', [1000.0 * float(b) for b in xs_obs_limits_comb ])

xs_obs_limits_incl_fb = array('d', [1000.0 * float(b) for b in xs_obs_limits_incl ])

xs_exp_limits_0tag = array('d', [0.023812499046325684, 0.020687499046325684, 0.017687499523162842, 0.01481250047683716, 0.012562500238418579, 0.010906250476837158, 0.00959375023841858, 0.00849707007408142, 0.007593749761581421, 0.006781250238418579, 0.006078125238418579, 0.0055156248807907106, 0.005015624761581421, 0.004546875059604645, 0.004140625, 0.0037343749403953553, 0.0034218749403953554, 0.003125, 0.0028515625, 0.002601562440395355, 0.0023828125, 0.0021953125298023223, 0.0020234374701976776, 0.0018828125298023224, 0.0017421874403953552, 0.0016171875596046447, 0.0015117187798023223, 0.0014179687201976777, 0.0013242188096046449, 0.0012382812798023223, 0.0011601562798023224, 0.0010898437350988388, 0.00103515625, 0.0009726562350988389, 0.0009179687500000001, 0.0008632812649011613, 0.0008164062350988388, 0.0007695312798023224, 0.0007304687798023224, 0.0006914062798023224, 0.0006601562350988388, 0.0006210937350988389, 0.0005898437649011612, 0.00056640625, 0.0005351562425494194, 0.0005117187649011612, 0.00048828125, 0.00046484373509883884, 0.0004414062574505806, 0.0004179687425494194, 0.0004023437574505806, 0.0003789062425494194, 0.0003632812574505806, 0.0003476562350988388, 0.0003398437425494194, 0.0003242187574505806, 0.0003085937537252903, 0.0003007812425494194, 0.0002851562574505806, 0.0002773437462747097, 0.0002617187425494194, 0.00025390625, 0.00024609375745058063, 0.0002382812462747097, 0.0002304687537252903, 0.0002226562425494194, 0.00021484375, 0.0002070312574505806, 0.0001992187462747097, 0.0001914062537252903, 0.0001914062537252903, 0.0001835937425494194, 0.00017578125, 0.00017578125, 0.0001679687574505806, 0.0001679687574505806, 0.0001601562462747097, 0.0001601562462747097, 0.0001523437537252903, 0.0001523437537252903])

xs_exp_limits_1tag = array('d', [0.01040624976158142, 0.009031249880790711, 0.007781249880790711, 0.006781250238418579, 0.005984374880790711, 0.00535937488079071, 0.004859375059604645, 0.0044218748807907104, 0.004078125059604645, 0.003765625059604645, 0.0034843748807907105, 0.0032656249403953553, 0.0030234375596046447, 0.0028203123807907103, 0.0026171875, 0.0023828125, 0.0022578124701976778, 0.0020859375596046447, 0.0019374999403953552, 0.0018046875298023224, 0.0016640624403953552, 0.0015585938096046449, 0.0014570312201976777, 0.0013554687798023224, 0.0012617187201976775, 0.0011835937201976777, 0.0011132812500000001, 0.0010429687798023223, 0.0009804687649011613, 0.0009257812798023225, 0.00087890625, 0.0008242187649011612, 0.0007851562649011612, 0.0007460937649011613, 0.0007070312649011612, 0.0006679687649011612, 0.0006367187201976776, 0.00060546875, 0.0005742187425494195, 0.0005507812649011612, 0.0005195312574505807, 0.0004960937425494194, 0.0004726562649011612, 0.0004570312425494194, 0.0004335937649011612, 0.00041015625, 0.0003945312649011612, 0.0003789062425494194, 0.0003554687649011612, 0.0003398437425494194, 0.0003242187574505806, 0.0003164062649011612, 0.0003007812425494194, 0.0002851562574505806, 0.0002773437462747097, 0.0002617187425494194, 0.00025390625, 0.00024609375745058063, 0.0002304687537252903, 0.0002226562425494194, 0.00021484375, 0.0002070312574505806, 0.0001992187462747097, 0.0001914062537252903, 0.0001914062537252903, 0.0001835937425494194, 0.00017578125, 0.0001679687574505806, 0.0001679687574505806, 0.0001601562462747097, 0.0001523437537252903, 0.0001523437537252903, 0.00014453125186264515, 0.00014453125186264515, 0.00013671875, 0.00013671875, 0.00013671875, 0.00012890624813735485, 0.00012890624813735485, 0.00012890624813735485])

xs_exp_limits_comb = array('d', [0.00921875, 0.007906249761581422, 0.006781250238418579, 0.00589062511920929, 0.00520312488079071, 0.00464062511920929, 0.004203124940395355, 0.003828125, 0.003515625, 0.0032343751192092894, 0.0029921874403953555, 0.0027734375, 0.0025546875596046447, 0.0023671874403953554, 0.0021953125298023223, 0.0020234374701976776, 0.0018593749403953553, 0.0017109374701976777, 0.0015859374403953553, 0.00146484375, 0.0013554687798023224, 0.0012617187201976775, 0.001167968735098839, 0.0010898437350988388, 0.0010117187350988388, 0.0009414062649011612, 0.0008867187798023224, 0.0008320312201976776, 0.0007773437350988388, 0.0007304687798023224, 0.0006914062798023224, 0.00064453125, 0.0006132812425494194, 0.0005820312350988388, 0.0005507812649011612, 0.0005195312574505807, 0.00048828125, 0.00046484373509883884, 0.0004414062574505806, 0.0004179687425494194, 0.0003945312649011612, 0.0003789062425494194, 0.0003554687649011612, 0.0003398437425494194, 0.0003242187574505806, 0.0003085937537252903, 0.00029296875, 0.0002773437462747097, 0.0002617187425494194, 0.00025390625, 0.0002382812462747097, 0.0002304687537252903, 0.0002226562425494194, 0.0002070312574505806, 0.0001992187462747097, 0.0001914062537252903, 0.0001835937425494194, 0.00017578125, 0.0001679687574505806, 0.0001601562462747097, 0.0001523437537252903, 0.0001523437537252903, 0.00014453125186264515, 0.00013671875, 0.00012890624813735485, 0.00012890624813735485, 0.0001210937462747097, 0.0001210937462747097, 0.0001132812537252903, 0.0001132812537252903, 0.00010546875186264516, 0.00010546875186264516, 9.765625e-05, 9.765625e-05, 9.765625e-05, 8.984374813735486e-05, 8.984374813735486e-05, 8.984374813735486e-05, 8.20312462747097e-05, 8.20312462747097e-05])

xs_exp_limits_incl = array('d', [0.018687499761581423, 0.01568750023841858, 0.0134375, 0.01171875, 0.010343749523162842, 0.00921875, 0.00828125, 0.00753125011920929, 0.006843749880790711, 0.0062812501192092895, 0.00573437511920929, 0.0052656251192092895, 0.00479687511920929, 0.004390625059604645, 0.004015625119209289, 0.0036718750000000002, 0.003359375, 0.0030859375, 0.0028359374403953553, 0.002601562440395355, 0.002398437559604645, 0.0022265625000000002, 0.0020703125, 0.0019140625, 0.0017890624701976776, 0.0016640624403953552, 0.0015585938096046449, 0.0014570312201976777, 0.0013632813096046447, 0.0012851563096046448, 0.0012070312350988387, 0.0011367187649011612, 0.0010664062201976776, 0.0010039062798023223, 0.0009492187201976776, 0.0008945312350988388, 0.00083984375, 0.0007929687201976777, 0.0007539062201976776, 0.0007148437201976776, 0.0006679687649011612, 0.0006367187201976776, 0.00060546875, 0.0005742187425494195, 0.0005429687350988388, 0.0005195312574505807, 0.00048828125, 0.00046484373509883884, 0.0004414062574505806, 0.0004179687425494194, 0.0004023437574505806, 0.0003789062425494194, 0.0003632812574505806, 0.0003476562350988388, 0.00033203125, 0.0003164062649011612, 0.0003007812425494194, 0.0002851562574505806, 0.0002773437462747097, 0.0002617187425494194, 0.00025390625, 0.0002382812462747097, 0.0002304687537252903, 0.0002226562425494194, 0.00021484375, 0.0002070312574505806, 0.0001992187462747097, 0.0001914062537252903, 0.0001835937425494194, 0.00017578125, 0.00017578125, 0.0001679687574505806, 0.0001601562462747097, 0.0001601562462747097, 0.0001523437537252903, 0.00014453125186264515, 0.00014453125186264515, 0.00013671875, 0.00013671875, 0.00012890624813735485])

xs_exp_limits_0tag_fb = array('d', [1000.0 * float(b) for b in xs_exp_limits_0tag ])

xs_exp_limits_1tag_fb = array('d', [1000.0 * float(b) for b in xs_exp_limits_1tag ])

xs_exp_limits_comb_fb = array('d', [1000.0 * float(b) for b in xs_exp_limits_comb ])

xs_exp_limits_incl_fb = array('d', [1000.0 * float(b) for b in xs_exp_limits_incl ])

masses_bstar =  array('d', [ 1.0,     1.1,     1.2,      1.3,      1.4,    1.5,     1.6,     1.7,      1.8,      1.9,  
                             2.0,     2.1,     2.2,      2.3,      2.4,    2.5,     2.6,     2.7,      2.8,      2.9,  
                             3.0,     3.1,     3.2,      3.3,      3.4,    3.5,     3.6,     3.7,      3.8,      3.9,  
                             4.0,     4.1,     4.2,      4.3,      4.4,    4.5,     4.6,     4.7,      4.8,      4.9,  
                             5.0 ])

xs_bstar_f1p0 = array('d', [2.148e-01, 1.286e-01, 7.982e-02, 5.043e-02, 3.314e-02, 2.204e-02, 1.501e-02, 1.026e-02, 7.191e-03, 5.034e-03, 3.585e-03, 2.592e-03, 1.865e-03, 1.366e-03, 1.000e-03, 7.488e-04, 5.524e-04, 4.116e-04, 3.058e-04, 2.337e-04, 1.766e-04, 1.326e-04, 1.013e-04, 7.705e-05, 5.879e-05, 4.517e-05, 3.442e-05, 2.646e-05, 2.011e-05, 1.566e-05, 1.202e-05, 9.259e-06, 7.101e-06, 5.442e-06, 4.238e-06, 3.289e-06, 2.545e-06, 1.974e-06, 1.528e-06, 1.182e-06, 9.216e-07])

eff_bstar_f1p0    = array('d', [ 0.290111, 0.288076, 0.286042, 0.284007, 0.281972, 0.279937, 0.276618, 0.273298, 0.269979, 0.26666 , 0.26334 , 0.259386, 0.255432, 0.251478, 0.247524, 0.243569, 0.240403, 0.237238, 0.234072, 0.230906, 0.22774 , 0.226535, 0.22533 , 0.224125, 0.22292 , 0.221715, 0.220797, 0.21988 , 0.218962, 0.218044, 0.217127, 0.216768, 0.21641 , 0.216051, 0.215693, 0.215334, 0.215426, 0.215519, 0.215611, 0.215704, 0.215796 ])

xsEff_f1p0 = array('d', [float(b) * float(m) for b,m in zip(xs_bstar_f1p0, eff_bstar_f1p0)])
xsEff_f1p0_fb = array('d', [1000.0 * float(b) for b in xsEff_f1p0])

graph_exp_combine = TGraph(len(masses_tev),masses_tev,xs_exp_limits_comb_fb)
#graph_exp_combine.SetFillColor(kYellow)

#graph_exp_0tag = TGraph(len(masses_tev),masses_tev,xs_exp_limits_0tag_fb)
graph_exp_0tag = TGraph(len(masses_tev),masses_tev,xs_exp_limits_incl_fb) ##inclusive one q*
graph_exp_0tag.SetLineWidth(2)
graph_exp_0tag.SetLineStyle(2)
graph_exp_0tag.SetLineColor(kOrange+2)

graph_exp_0tag.GetXaxis().SetTitle("Resonance Mass [TeV]")
graph_exp_0tag.GetYaxis().SetTitle("#sigma #times B #times A #times #epsilon [fb]")
graph_exp_0tag.GetYaxis().SetRangeUser(5e-2,30)
graph_exp_0tag.GetXaxis().SetNdivisions(510)
graph_exp_0tag.GetXaxis().SetLimits(1.0,5.0)
graph_exp_combine.SetLineWidth(2)
graph_exp_combine.SetLineStyle(2)
graph_exp_combine.SetLineColor(kRed+2)

graph_exp_0tag.GetYaxis().CenterTitle()
graph_exp_0tag.GetYaxis().SetLabelSize(0.04)
graph_exp_0tag.GetYaxis().SetTitleOffset(1.1)
graph_exp_0tag.GetXaxis().CenterTitle()
graph_exp_0tag.GetXaxis().SetLabelSize(0.04)
graph_exp_0tag.GetXaxis().SetTitleOffset(1.1)
graph_exp_0tag.GetXaxis().CenterTitle()

graph_exp_1tag = TGraph(len(masses_tev),masses_tev,xs_exp_limits_1tag_fb)
graph_exp_1tag.SetLineWidth(2)
graph_exp_1tag.SetLineStyle(2)
graph_exp_1tag.SetLineColor(kCyan+2)

graph_obs_combine = TGraph(len(masses_tev),masses_tev,xs_obs_limits_comb_fb)
graph_obs_combine.SetMarkerStyle(25)
graph_obs_combine.SetMarkerColor(kRed+2)
graph_obs_combine.SetLineWidth(2)
graph_obs_combine.SetLineStyle(1)
graph_obs_combine.SetLineColor(kRed+2)

graph_obs_1tag =TGraph(len(masses_tev),masses_tev,xs_obs_limits_1tag_fb)
graph_obs_1tag.SetMarkerStyle(21)
graph_obs_1tag.SetMarkerColor(kCyan+2)
graph_obs_1tag.SetLineWidth(2)
graph_obs_1tag.SetLineStyle(1)
graph_obs_1tag.SetLineColor(kCyan+2)

#graph_obs_0tag =TGraph(len(masses_tev),masses_tev,xs_obs_limits_0tag_fb)
graph_obs_0tag =TGraph(len(masses_tev),masses_tev,xs_obs_limits_incl_fb)##inclusive one q*
graph_obs_0tag.SetMarkerStyle(24)
graph_obs_0tag.SetMarkerColor(kOrange+2)
graph_obs_0tag.SetLineWidth(2)
graph_obs_0tag.SetLineStyle(1)
graph_obs_0tag.SetLineColor(kOrange+2)

graph_bstar = TGraph(len(masses_bstar),masses_bstar,xsEff_f1p0_fb)
graph_bstar.SetLineWidth(2)                
graph_bstar.SetLineColor(kGray+2)
graph_bstar.SetLineStyle(8)

c = TCanvas("c", "",800,800)
c.cd()


graph_exp_0tag.Draw("AL")
graph_exp_1tag.Draw("L")
graph_exp_combine.Draw("L")
graph_obs_0tag.Draw("LP")
graph_obs_1tag.Draw("LP")
graph_obs_combine.Draw("LP")
graph_bstar.Draw("L")

##legend = TLegend(.55,.69,.85,.92)  ## for pas twiki
legend = TLegend(.54,.54,.76,.75)
legend.SetBorderSize(0)
legend.SetFillColor(0)
legend.SetFillStyle(0)
legend.SetTextFont(42)
legend.SetTextSize(0.031)
legend.SetHeader('95% CL upper limits')
#legend.AddEntry(graph_obs_0tag,"Obs. lmt (0tag category)","lp")
legend.AddEntry(graph_obs_0tag,"Obs. lmt (Inclusive category)","lp")
legend.AddEntry(graph_obs_1tag,"Obs. lmt (1tag category)","lp")
legend.AddEntry(graph_obs_combine,"Obs. lmt (Combine category)","lp")
#legend.AddEntry(graph_exp_0tag,"Exp. lmt (0tag category)","l")
legend.AddEntry(graph_exp_0tag,"Exp. lmt (Inclusive category)","l")
legend.AddEntry(graph_exp_1tag,"Exp. lmt (1tag category)","l")
legend.AddEntry(graph_exp_combine,"Exp. lmt (Combine category)","l")
legend.AddEntry(graph_bstar,"Excited b-quark (f = 1.0)","l")
legend.Draw()

lumiTextSize = 0.6
lumiTextOffset = 0.2
lumi = TLatex()
lumi.SetNDC()
lumi.SetTextAngle(0)
lumi.SetTextColor(kBlack)
lumi.SetTextFont(42)
lumi.SetTextAlign(31)
lumi.SetTextSize(lumiTextSize*t_m)
lumi.DrawLatex(1 - r_m, 1 - t_m +  lumiTextOffset*t_m, "35.9 fb^{-1} (13 TeV)")

cmsTextFont = 61
cmsTextSize = 0.75
extraTextFont = 52
extraOverCmsTextSize = 0.76
relExtraDY = 1.2
##posX_ = l_m     + 0.045 * (1 - l_m - r_m)  ##Top left
##posX_ = l_m     + 0.5   * (1 - l_m - r_m)   ## Centre
posX_ = 1 - r_m + 0.045 * (1 - l_m - r_m)  ## Top right
posY_ = 1 - t_m - 0.035 * (1 - t_m - b_m)

cms =  TLatex()
cms.SetNDC()
cms.SetTextFont(cmsTextFont)
cms.SetTextSize(cmsTextSize * t_m)
cms.SetTextAlign(33)  ### 11-top left;  21-top centre;  31-top right
##cms.DrawLatex(posX_, posY_, "CMS")
cms.DrawLatex(0.9, 0.92, "CMS")

### if extra text (Unpublished or Preliminary)
cms.SetTextFont(extraTextFont);
cms.SetTextAlign(33);
cms.SetTextSize(extraOverCmsTextSize*cmsTextSize*t_m);
##cms.DrawLatex(posX_, posY_- relExtraDY*cmsTextSize*t_m, extraText);
#cms.DrawLatex(0.9, 0.9 - relExtraDY*cmsTextSize*t_m, "Preliminary");

l1 = TLatex()
l1.SetNDC()
l1.SetTextAlign(13)
l1.SetTextFont(62)
l1.SetTextSize(0.04)
l1.SetTextFont(42)
l1.DrawLatex(0.78,0.85, "b*#rightarrow b#gamma") ##0.21,0.26


gPad.RedrawAxis();

c.SetLogy()
#c.SaveAs('LimitComp_bstar_1tagCategory_vs_0tagCategory_vs_CombineCategory.pdf')
#c.SaveAs('LimitComp_bstar_1tagCategory_vs_0tagCategory_vs_CombineCategory.png')

c.SaveAs('LimitComp_bstar_1tagCategory_vs_InclusiveCategory_vs_CombineCategory.pdf')
c.SaveAs('LimitComp_bstar_1tagCategory_vs_InclusiveCategory_vs_CombineCategory.png')


